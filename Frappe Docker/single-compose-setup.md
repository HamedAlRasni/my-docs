# إعداد ملف واحد للتكوين

هذا الإعداد هو ملف تكوين واحد بسيط جدًا يفعل كل شيء لبدء الخدمات المطلوبة ومقاعد البيانات (bench) الخاصة بـ frappe. يُستخدم لبدء تشغيل مثيل Docker للعب معه مع موقع. يقع الملف في الجذر للمستودع ويسمى `pwd.yml`.

## الخدمات

### مكونات bench الخاصة بـ frappe

- backend، يخدم الخلفية gunicorn.
- frontend، يخدم الأصول الثابتة من خلال النهج الأمامي لـ nginx الذي يقوم بعكس الوكيل لـ websocket و gunicorn.
- queue-long، مُعالج الطلبات rq طويلة الأجل والافتراضية والقصيرة.
- queue-short، مُعالج الطلبات rq الافتراضي والقصير.
- schedule، مُجدول الأحداث.
- websocket، websocket socketio للتواصل الحيوي في الوقت الفعلي.

### التكوين مرة واحدة

- configurator، يكوّن `common_site_config.json` لتعيين مضيفي قاعدة البيانات والريديس.
- create-site، ينشئ موقعًا واحدًا ليكون الموقع الافتراضي لمقاعد البيانات (bench) الخاصة بـ frappe.

### تبعية الخدمة

- db، mariadb، حاوية بتكوينات خاصة بـ frappe.
- redis-cache، redis لبيانات الذاكرة المؤقتة.
- redis-queue، redis لبيانات الـ rq والنشر/الاشتراك.

## الأحجام

- sites: حجم لبيانات bench. سيتم تخزين التكوين المشترك، جميع المواقع، جميع تكوينات المواقع وملفات الموقع هنا.
- logs: حجم لسجلات bench. يتم إلقاء سجلات جميع العمليات هنا. لا حاجة لتثبيته. ستنشئ كل حاوية حجمًا مؤقتًا للسجلات إذا لم يتم تحديده.

## التكيف

إذا فهمت استخدام الحاويات، استخدم `pwd.yml` كمرجع لإنشاء إعدادات أكثر تعقيدًا مثل مثال خادم واحد، مكدس Docker Swarm، مخطط Kubernetes Helm، إلخ.

يخدم هذا الموقع فقط الموقع المسمى `frontend` من خلال nginx. تم تعيين `FRAPPE_SITE_NAME_HEADER` إلى `frontend` وتم إنشاء موقع افتراضي يسمى `frontend`.

سيسمح تغيير `$$host` للحاوية بقبول أي عنوان مضيف وخدمة ذلك الموقع. لتجاوز `$` في yaml التكوين، استخدمه مثل `$$`. لإلغاء تعيين الموقع الافتراضي، قم بإزالة ملف `currentsite.txt` من دليل `sites`.